/**
	* GetTweets v@VERSION
	*
	* A jQuery plugin to retrive tweets from multiple users
	*
	* https://github.com/adamatmonk/jquery-gettweets
	*
	* Copyright 2011 by Adam Randlett
    * Released under the MIT License
    * http://en.wikipedia.org/wiki/MIT_License
**/
(function(a){a.fn.getTweets=function(c,e){var d={twitter_api_url:"http://api.twitter.com/1/statuses/user_timeline",twitter_search_url:"http://search.twitter.com/search",twitter_users:["monkdev"],twitter_queries:[],_isSearch:false,format:"json",howmany:4,retweets:false,no_replies:false,rate_limit_status:false,tweetstring:"<div class='tweet'><div class='header'><p class='summary'>{tweettext}</p><p class='meta'>{tweetdate} by <a href='http://twitter.com/{tweetuser:screenname}'>{tweetuser:name}</a></p></div> <div class='image'><a href='http://twitter.com/{tweetuser:screenname}'><img src='{tweetuser:image}' width='48' height='48'></a></div></div>",retweetstring:"<div class='tweet'><div class='header'><p class='summary'>{tweettext}</p><p class='meta'>{tweetdate} <a href='http://twitter.com/{retweetuser:screenname}'>{retweetuser:name}</a> <span class='rt'>retweeted</span> by <a href='http://twitter.com/{tweetuser:screenname}'>{tweetuser:name}</a> </p></div> <div class='image'><a href='http://twitter.com/{tweetuser:screenname}'><img src='{retweetuser:image}' width='48' height='48'></a></div></div>"};var b=a.extend(d,c);return this.each(function(){var n=a(this),p={twitter_users:b.twitter_users,twitter_queries:b.twitter_queries,howmany:b.howmany,tweetstring:b.tweetstring,retweetstring:b.retweetstring,retweets:b.retweets,no_replies:b.no_replies,rate_limit_status:b.rate_limit_status},f=[],h,o=p.twitter_users.length-1,g=p.twitter_queries.length-1;function i(s){var r=s.split(" ");var s=b._isSearch?r[2]+" "+r[1]+", "+r[3]+" "+r[4]:r[1]+" "+r[2]+", "+r[5]+" "+r[3];var q=Date.parse(s);var t=(arguments.length>1)?arguments[1]:new Date();var u=parseInt((t.getTime()-q)/1000);u=u+(t.getTimezoneOffset()*60);if(u<60){return"less than a minute ago";}else{if(u<120){return"about a minute ago";}else{if(u<(60*60)){return(parseInt(u/60)).toString()+" minutes ago";}else{if(u<(120*60)){return"about an hour ago";}else{if(u<(24*60*60)){return"about "+(parseInt(u/3600)).toString()+" hours ago";}else{if(u<(48*60*60)){return"1 day ago";}else{return(parseInt(u/86400)).toString()+" days ago";}}}}}}}String.prototype.parseUrl=function(){var q=new RegExp(/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi);return this.replace(q,function(r){return'<a href="'+r+'">'+r+"</a>";});};String.prototype.parseUsername=function(){return this.replace(new RegExp(/[@]+[A-Za-z0-9-_]+/g),function(q){var r=q.replace("@","");return q.link("http://twitter.com/"+r);});};String.prototype.parseHashtag=function(){return this.replace(new RegExp(/[#]+[A-Za-z0-9-_]+/g),function(r){var q=r.replace("#","%23");return r.link("http://search.twitter.com/search?q="+q);});};String.prototype.multiReplace=function(r){var s=this,q;for(q in r){s=s.replace(new RegExp(q,"g"),r[q]);}return s;};function k(q){a.each(q,function(s,w){if(w.text!==undefined){var v=w.text,t;if(b._isSearch){t={"{tweetdate}":i(w.created_at),"{tweeturl}":"http://www.twitter.com/"+w.from_user_name+"/status/"+w.id_str,"{tweettext}":v.parseUrl().parseUsername().parseHashtag(),"{tweetuser:name}":w.from_user_name,"{tweetuser:screenname}":w.from_user};}else{t={"{tweetdate}":i(w.created_at),"{tweeturl}":"http://www.twitter.com/"+w.user.screen_name+"/status/"+w.id_str,"{tweettext}":v.parseUrl().parseUsername().parseHashtag(),"{tweetuser:name}":w.user.name,"{tweetuser:screenname}":w.user.screen_name,"{tweetuser:location}":w.user.location,"{tweetuser:description}":w.user.description,"{tweetuser:url}":w.user.url,"{tweetuser:image}":w.user.profile_image_url,"{tweetsource}":w.source};}var u,r;if(w.retweeted_status){t["{retweetuser:name}"]=w.retweeted_status.user.name;t["{retweetuser:screenname}"]=w.retweeted_status.user.screen_name;t["{retweetuser:image}"]=w.retweeted_status.user.profile_image_url;r=p.retweetstring;}else{r=p.tweetstring;}var u=r.multiReplace(t);f.push({id:w.id,status:u});}});}function l(){f.sort(function(s,r){return(r.id-s.id);});twitter_count=f.length;for(var q=0;q<p.howmany;q++){n.append(f[q].status);}if(typeof e=="function"){e.call(this);}}function m(q){a.getJSON("http://api.twitter.com/1/account/rate_limit_status.json?&callback=?",function(r){console.log("-------------------------------------------------------");console.log("RATE LIMIT STATUS");console.log("  Hourly Limit: "+r.hourly_limit);console.log("  Remaining Hits: "+r.remaining_hits);console.log("  Reset Time: "+r.reset_time);console.log("-------------------------------------------------------");});}function j(q){if(p.twitter_queries.length>0){b._isSearch=true;a.ajax({dataType:"jsonp",url:b.twitter_search_url+"."+b.format+"?&q="+encodeURIComponent(p.twitter_queries[q])+"&include_entities=true"+"&rpp="+p.howmany+"&callback=?",timeout:1000,type:"GET",async:false,crossDomain:true,error:function(){},success:function(r){k(r.results);},complete:function(){if(q<g){j(++q);}else{l();}}});}else{a.ajax({dataType:"jsonp",url:b.twitter_api_url+"."+b.format+"?&screen_name="+p.twitter_users[q]+"&include_rts="+p.retweets+"&exclude_replies="+p.replies+"&count="+p.howmany+"&callback=?",timeout:1000,type:"GET",async:false,crossDomain:true,error:function(){},success:function(r){k(r);},complete:function(){if(q<o){j(++q);}else{l();}}});}}if(p.rate_limit_status){m();}j(0);});};})(jQuery);